"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([[4828],{2916:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"about/usage/basic-usage","title":"Basic usage","description":"The module is imported with","source":"@site/docs/about/usage/basic-usage.md","sourceDirName":"about/usage","slug":"/about/usage/basic-usage","permalink":"/tagreader-python/docs/about/usage/basic-usage","draft":false,"unlisted":false,"editUrl":"https://github.com/equinor/tagreader-python/tree/main/documentation/docs/about/usage/basic-usage.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"about","previous":{"title":"Usage","permalink":"/tagreader-python/docs/category/usage"},"next":{"title":"Data sources","permalink":"/tagreader-python/docs/about/usage/data-source"}}');var i=t(4848),r=t(8453);const a={sidebar_position:1},d="Basic usage",l={},o=[{value:"The Client",id:"the-client",level:2},{value:"Creating a client",id:"creating-a-client",level:2},{value:"Connecting to data source",id:"connecting-to-data-source",level:2},{value:"Searching for tags",id:"searching-for-tags",level:2},{value:"Reading data",id:"reading-data",level:2},{value:"Selecting what to read",id:"selecting-what-to-read",level:2},{value:"Status information",id:"status-information",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"basic-usage",children:"Basic usage"})}),"\n",(0,i.jsx)(n.p,{children:"The module is imported with"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import tagreader\n"})}),"\n",(0,i.jsx)(n.h2,{id:"the-client",children:"The Client"}),"\n",(0,i.jsx)(n.p,{children:"The client presents the interface for communicating with the data source to the user. The interface shall be as unified\nas possible, regardless of the IMS type that is used. A handler object specifically designed for each IMS type is\nattached to the client when the client is created. The handler is responsible for handling the communication and data\ninterpretation between the server and the client object."}),"\n",(0,i.jsxs)(n.admonition,{title:"SSL verification",type:"info",children:[(0,i.jsx)(n.p,{children:"Equinor root certificates are automatically added when using an Equinor Managed computer, which allow SSL verification."}),(0,i.jsxs)(n.p,{children:["For non-Equinor users: If you run info SSL verification errors and prefer to not set ",(0,i.jsx)(n.code,{children:"verify_ssl=False"})," ,\nyou can try the procedure outlined ",(0,i.jsx)(n.a,{href:"https://incognitjoe.github.io/adding-certs-to-requests.html",children:"here"}),"."]})]}),"\n",(0,i.jsxs)(n.admonition,{title:"ODBC support",type:"info",children:[(0,i.jsxs)(n.p,{children:["Tagreader as of version 5 does no longer support ODBC clients, which has been deprecated in favor of REST services.\nTo use ODBC, please refer to ",(0,i.jsx)(n.a,{href:"https://pypi.org/project/tagreader/#history",children:"Tagreader v4 on PyPI"}),".\nVersioned documentation is available in the source code on ",(0,i.jsx)(n.a,{href:"https://github.com/equinor/tagreader-python/releases",children:"GitHub Releases"}),"."]}),(0,i.jsx)(n.p,{children:"Use at your own discretion."})]}),"\n",(0,i.jsx)(n.h2,{id:"creating-a-client",children:"Creating a client"}),"\n",(0,i.jsxs)(n.p,{children:["A connection to a data source is prepared by creating an instance of ",(0,i.jsx)(n.code,{children:"tagreader.IMSClient"})," with the following input\narguments:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"datasource"})," : Name of data source"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"imstype"})," : The name of the ",(0,i.jsx)(n.a,{href:"/docs/about/usage/data-source",children:"IMS type"})," to query. Indicates the type of data source\nthat is requested, and therefore determines which handler type to use. Valid values are\n",(0,i.jsx)(n.code,{children:"piwebapi"})," and ",(0,i.jsx)(n.code,{children:"aspenone"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tz"})," (optional): Time zone naive time stamps will be interpreted as belonging to this time zone. Similarly,\nthe returned data points will be localized to this time zone. ",(0,i.jsx)(n.strong,{children:"Default"}),": ",(0,i.jsx)(n.em,{children:'"Europe/Oslo"'}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The following input arguments can be used when connecting to either ",(0,i.jsx)(n.code,{children:"piwebapi"})," or to ",(0,i.jsx)(n.code,{children:"aspenone"}),". None of these\nshould be necessary to supply when connecting to Equinor servers."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"url"})," (optional): Path to server root, e.g. ",(0,i.jsxs)(n.em,{children:['"',(0,i.jsx)(n.a,{href:"https://aspenone/ProcessData/AtProcessDataREST.dll",children:"https://aspenone/ProcessData/AtProcessDataREST.dll"}),'"']}),"\nor ",(0,i.jsxs)(n.em,{children:['"',(0,i.jsx)(n.a,{href:"https://piwebapi/piwebapi",children:"https://piwebapi/piwebapi"}),'"']}),". ",(0,i.jsx)(n.strong,{children:"Default"}),": Path to Equinor server corresponding to selected ",(0,i.jsx)(n.code,{children:"imstype"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"verify_ssl"})," (optional): Whether to verify SSL certificate sent from server. ",(0,i.jsx)(n.strong,{children:"Default"}),": ",(0,i.jsx)(n.code,{children:"True"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"auth"})," (optional): Auth object to pass to the server for authentication. ",(0,i.jsx)(n.strong,{children:"Default"}),": Kerberos-based auth object\nthat works with Equinor servers."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"cache"})," (optional): ",(0,i.jsx)(n.a,{href:"/tagreader-python/docs/about/usage/caching",children:"Cache"})," data locally in order to avoid re-reading the same data multiple times."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"connecting-to-data-source",children:"Connecting to data source"}),"\n",(0,i.jsxs)(n.p,{children:["After creating the client as described above, connect to the server with the ",(0,i.jsx)(n.code,{children:"connect()"})," method."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example"})}),"\n",(0,i.jsx)(n.p,{children:"Connecting to the PINO PI data source using REST Web API:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'c = tagreader.IMSClient("PINO", "piwebapi")\nc.connect()\n'})}),"\n",(0,i.jsx)(n.p,{children:"Connecting to the Peregrino IP.21 data source using AspenTech Process Data REST Web API, specifying that all naive time\nstamps as well as the returned data shall use Rio local time, and using the local endpoint in Brazil:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'c = tagreader.IMSClient(datasource="PER",\n                        imstype="aspenone",\n                        tz="Brazil/East",\n                        url="https://aspenone-per.equinor.com/ProcessExplorer/ProcessData/AtProcessDataREST.dll")\nc.connect()\n'})}),"\n",(0,i.jsx)(n.p,{children:"Connecting to some other AspenTech Web API URL using NTLM authentication instead of default Kerberos and ignoring the\nserver's host certificate:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import getpass\nfrom requests_ntlm import HttpNtlmAuth\nuser = "mydomain\\\\" + getpass.getuser()\npwd = getpass.getpass()\nauth = HttpNtlmAuth(user, pwd)\nc = tagreader.IMSClient(datasource="myplant",\n                        url="https://api.mycompany.com/aspenone",\n                        imstype="aspenone",\n                        auth=auth,\n                        verify_ssl=False)\nc.connect()\n'})}),"\n",(0,i.jsx)(n.h2,{id:"searching-for-tags",children:"Searching for tags"}),"\n",(0,i.jsxs)(n.p,{children:["The client method ",(0,i.jsx)(n.code,{children:"search()"})," can be used to search for tags using either tag name, tag description or both."]}),"\n",(0,i.jsx)(n.p,{children:"Supply at least one of the following arguments:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"tag"})," : Name of tag"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"desc"})," : Description of tag"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"If both arguments are provided, the both must match."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"*"})," can be used as wildcard."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Examples"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'c = tagreader.IMSClient("PINO", "piwebapi")\nc.connect()\nc.search("cd*158")\nc.search(desc="*reactor*")\nc.search(tag="BA:*", desc="*Temperature*")\n'})}),"\n",(0,i.jsx)(n.h2,{id:"reading-data",children:"Reading data"}),"\n",(0,i.jsxs)(n.p,{children:["Data is read by calling the client method ",(0,i.jsx)(n.code,{children:"read()"})," with the following input arguments:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tags"})," : List of tagnames. Wildcards are not allowed."]}),"\n",(0,i.jsxs)(n.p,{children:["Tags with maps (relevant for some InfoPlus.21 servers) can be on the form ",(0,i.jsx)(n.code,{children:"'tag;map'"})," , e.g. ",(0,i.jsx)(n.code,{children:"'109-HIC005;CS A_AUTO'"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"start_time"})," : Start of time period."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"end_time"})," : End of time period."]}),"\n",(0,i.jsxs)(n.p,{children:["Both ",(0,i.jsx)(n.code,{children:"start_time"})," and ",(0,i.jsx)(n.code,{children:"end_time"})," can be either datetime object or string. Strings are interpreted by the"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Timestamp.html",children:"Timestamp"})," method from Pandas.\nBoth timestamps can be left out when ",(0,i.jsx)(n.code,{children:"read_type = ReaderType.SNAPSHOT"})," . However, when using either of the Web APIs, ",(0,i.jsx)(n.code,{children:"end_time"})," provides the time at which the snapshot is taken."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"ts"})," : The interval between samples when querying interpolated or aggregated data. Ignored and can be left out when\n",(0,i.jsx)(n.code,{children:"read_type = ReaderType.SNAPSHOT"})," . ",(0,i.jsx)(n.strong,{children:"Default"})," 60 seconds."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"read_type"})," (optional): What kind of data to read. More info immediately below. ",(0,i.jsx)(n.strong,{children:"Default"})," Interpolated."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"get_status"})," (optonal): When set to ",(0,i.jsx)(n.code,{children:"True"})," will fetch status information in addition to values. ",(0,i.jsx)(n.strong,{children:"Default"})," ",(0,i.jsx)(n.code,{children:"False"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"selecting-what-to-read",children:"Selecting what to read"}),"\n",(0,i.jsxs)(n.p,{children:["By specifying the optional parameter ",(0,i.jsx)(n.code,{children:"read_type"})," to ",(0,i.jsx)(n.code,{children:"read()"})," , it is possible to specify what kind of data should be\nreturned. The default query method is interpolated. All valid values for ",(0,i.jsx)(n.code,{children:"read_type"})," are defined in the\n",(0,i.jsx)(n.code,{children:"utils.ReaderType"})," class (mirrored for convenience as ",(0,i.jsx)(n.code,{children:"tagreader.ReaderType"})," ), although not all are currently\nimplemented. Below is the list of implemented read types."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"INT"})," : The raw data points are interpolated so that one new data point is generated at each step of length ",(0,i.jsx)(n.code,{children:"ts"})]}),"\n",(0,i.jsxs)(n.li,{children:["starting at ",(0,i.jsx)(n.code,{children:"start_time"})," and ending at or less than ",(0,i.jsx)(n.code,{children:"ts"})," seconds before ",(0,i.jsx)(n.code,{children:"end_time"})," ."]}),"\n",(0,i.jsxs)(n.li,{children:["The following aggregated read types perform a weighted calculation of the raw data within each interval.\nWhere relevant, time-weighted calculations are used. Returned time stamps are anchored at the beginning of each\ninterval. So for the 60 seconds long interval between 08:11:00 and 08:12:00, the time stamp will be 08:11:00.","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"MIN"})," : The minimum value."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"MAX"})," : The maximum value."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AVG"})," : The average value."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"VAR"})," : The variance."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"STD"})," : The standard deviation."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RNG"})," : The range (max-min)."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RAW"})," : Returns actual data points stored in the database."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"SNAPSHOT"})," : Returns the last recorded value. Only one tag can be read at a time. When using either of the Web API\nbased handlers, providing ",(0,i.jsx)(n.code,{children:"end_time"})," is possible in which case a snapshot at the specific time is returned."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Examples"})}),"\n",(0,i.jsx)(n.p,{children:"Read interpolated data for the provided tag with 3-minute intervals between the two time stamps:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"c = tagreader.IMSClient(\"PINO\", \"piwebapi\")\nc.connect()\ndf = c.read(['BA:ACTIVE.1'], '05-Jan-2020 08:00:00', '05/01/20 11:30am', 180)\n\n"})}),"\n",(0,i.jsx)(n.p,{children:"Read the average value for the two provided tags within each 3-minute interval between the two time stamps:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"df = c.read(['BA:CONC.1'], '05-Jan-2020 08:00:00', '05/01/20 11:30am', 180, read_type=tagreader.ReaderType.AVG)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"status-information",children:"Status information"}),"\n",(0,i.jsxs)(n.p,{children:["The optional parameter ",(0,i.jsx)(n.code,{children:"get_status"})," was added to ",(0,i.jsx)(n.code,{children:"IMSClient.read()"})," in release 2.6.0. If set to ",(0,i.jsx)(n.code,{children:"True"}),", the resulting\ndataframe will be expanded with one additional column per tag. The column contains integer numbers that indicate the\nstatus, or quality, of the returned values."]}),"\n",(0,i.jsx)(n.p,{children:"In an effort to unify the status value for all IMS types, the following schema based on AspenTech was selected:"}),"\n",(0,i.jsx)(n.p,{children:"0: Good\n1: Suspect\n2: Bad\n4: Good/Modified\n5: Suspect/Modified\n6: Bad/Modified"}),"\n",(0,i.jsx)(n.p,{children:"The status value is obtained differently for the four IMS types:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Aspen Web API: Read directly from the ",(0,i.jsx)(n.code,{children:"l"}),' ("Level") field in the json output.']}),"\n",(0,i.jsxs)(n.li,{children:["PI Web API: Calculated as ",(0,i.jsx)(n.code,{children:"Questionable"})," + 2 * (1 - ",(0,i.jsx)(n.code,{children:"Good"}),") + 4 * ",(0,i.jsx)(n.code,{children:"Substituted"}),".\nnegative for various reasons for being bad."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["For the two PI IMS types, it is assumed that ",(0,i.jsx)(n.code,{children:"Questionable"})," is never ",(0,i.jsx)(n.code,{children:"True"})," if ",(0,i.jsx)(n.code,{children:"Good"})," is ",(0,i.jsx)(n.code,{children:"False"})," or ",(0,i.jsx)(n.code,{children:"status != 0"}),".\nThis may be an incorrect assumption with resulting erroneous status value."]}),"\n",(0,i.jsx)(n.p,{children:"In summary, here is the resulting status value from tagreader for different combinations of status field values from\nthe IMS types:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"tagreader"}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"Aspen Web API"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"PI Web API"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"0"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"l = 0"}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Good = True",(0,i.jsx)("br",{})," Questionable = False",(0,i.jsx)("br",{})," Substituted = False"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"1"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"l = 1"}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Good = True",(0,i.jsx)("br",{})," Questionable = True",(0,i.jsx)("br",{})," Substituted = False"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"2"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"l = 2"}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Good = False",(0,i.jsx)("br",{})," Questionable = False",(0,i.jsx)("br",{})," Substituted = False"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"4"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"l = 4"}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Good = True",(0,i.jsx)("br",{})," Questionable = False",(0,i.jsx)("br",{})," Substituted = True"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"5"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"l = 5"}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Good = True",(0,i.jsx)("br",{})," Questionable = True",(0,i.jsx)("br",{})," Substituted = True"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"6"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"l = 6"}),(0,i.jsxs)(n.td,{style:{textAlign:"left"},children:["Good = False",(0,i.jsx)("br",{})," Questionable = False",(0,i.jsx)("br",{})," Substituted = True"]})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Please keep in mind when using ",(0,i.jsx)(n.code,{children:"get_status"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This is an experimental feature. It may work as intended, or it may result in erroneous status values in some cases.\nIf that happens, please create an issue."}),"\n",(0,i.jsx)(n.li,{children:"Both how fetching status is activated and how it is returned may be changed at a later time."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);